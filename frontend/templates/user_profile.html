{% extends "base.html" %}
{% block title %}Mina sidor{% endblock %}
{% block content %}
<div class="profile-page">
  <!-- 1) Ett litet header-kort med titel & beskrivning -->
  <div class="profile-header-card">
    <h1>Mina sidor</h1>
    <p>Här kan du hantera dina prenumerationer och inställningar.</p>
  </div>

  <!-- 2) Flex-container med tre separata kort -->
  <div class="action-cards">
    <!-- Kort 1: Prenumerationsinfo -->
    {% if is_active_subscriber %}
    <div class="action-card info-card">
      <h3>Din prenumeration</h3>
      <ul>
        <li><strong>ID:</strong> {{ subscriber_id }}</li>
        <li><strong>Telefon:</strong> {{ phone_number }}</li>
        <li><strong>Län:</strong> {{ county }}</li>
      </ul>
    </div>

    <!-- Kort 2: Byt län -->
    <div class="action-card change-card">
      <h3>Byt län</h3>
      <form id="change-county-form" method="post">
        {% if csrf_token %}
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        {% endif %}
        <label for="new_county">Välj nytt län:</label>
        <select name="new_county" id="new_county" required>
          <option value="" disabled selected>Välj län</option>
        </select>
        <button type="submit" class="btn-primary">Uppdatera län</button>
      </form>
      <div id="county-response"></div>
    </div>

    <!-- Kort 3: Avsluta prenumeration -->
    <div class="action-card cancel-card">
      <h3>Avsluta prenumeration</h3>
      <form id="unsubscribe-form" method="post">
        {% if csrf_token %}
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        {% endif %}
        <button type="submit" class="btn-danger">Avbryt prenumeration</button>
      </form>
      <div id="unsubscribe-response"></div> <!-- För att visa meddelanden -->
    </div>
  </div>

  {% else %}
  <!-- Inget prenumerationskort -->
  <div class="action-card info-card">
    <h3>Ingen prenumeration</h3>
    <p>Du har ingen aktiv prenumeration. <a href="{{ url_for('subscriptions.show_subscription_page')}}">Starta en prenumeration</a>.</p>
  </div>
  {% endif %}
  </div>
</div>

<!-- JavaScript för att hantera "Byt Län"-funktionalitet -->
<script src="{{ url_for('static', filename='js/user_profile.js') }}"></script>

{% endblock %}
